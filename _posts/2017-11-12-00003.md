---
layout: docs
title:  "RSA 系列原理 备忘"
date:   2017-11-12
categories: RSA
enable_mathjax: true
enable_mermaid: false
enable_comments: true
---

# RSA 算法需要用到的数学知识

在此部分中: $$p, q$$ 代表两个质数，$$n, k \in N^*$$。

## 最基本的概念，不多作解释
+ 最大公约数 GCD 与互质的概念
+ 质数的概念
+ 同余方程 $$ a \equiv b\ (mod\ n) $$

## 欧拉函数
$$\phi(n)\ =$$ 所有小于等于$$n$$的正整数中，与$$n$$互质的数的个数。
下面列举几个常用的公式：
+ $$ \phi(1) = 1 $$
+ $$ \phi(p) = p - 1 $$
+ $$ \phi(p^k) = p^k - p^{k-1} $$
+ $$ \phi(pq) = (p-1)(q-1) $$

## 欧拉定理
+ 如果：

$$ gcd(n,a)=1\ (a \in N^*) $$

则：

$$ a^{\phi(n)} \equiv 1\ (mod\ n) $$

+ 特别的 如果：

$$ a < p , (a \in N^*)$$

则：

$$ a^{p-1} \equiv 1\ (mod\ p) $$

## 模反元素

如果：

$$ gcd(n,a)=1\ (a \in N^*) $$

则一定可以找到$$b \in N^*$$，使得

$$ ab \equiv 1\ (mod\ n) $$

此时，称$$b$$为$$a(mod\ n)$$的模反元素。

<hr>
# RSA 算法简单介绍 (来自[英文维基百科](https://en.wikipedia.org/wiki/RSA_(cryptosystem))的知识)

## 私钥(PRIVATE)的生成与公钥(PUBLIC)的导出

0. 首先生成两个随机质数$$p,q$$;
0. 计算$$n = pq$$;
0. 计算$$\phi(n)=\phi(pq)=(p-1)(q-1)$$;
0. 随机选择$$e<\phi(n)$$，使得$$gcd(e,\phi(n))=1$$;
   通常情况下 $$e=65537$$;
0. 计算$$e$$对$$\phi(n)$$的模反元素$$d$$;
0. 辅助计算变量$$ d_p=d\ mod\ (p-1) $$;
0. 辅助计算变量$$ d_q=d\ mod\ (q-1) $$;
0. 辅助计算变量$$ q_{inv} $$：$$q(mod\ n)$$的模反元素;

+ PRIVATE : $$p,q,n,\phi(n),e,d,d_p,d_q,q_{inv}$$
+ PUBLIC  : $$n,e$$

## 私钥签名解密 与 公钥加密验签
令：
- $$m$$为消息(message)
- $$c$$为加密消息（crypted）
- $$h$$为消息摘要(hash)
- $$s$$为签名(sign)

则：
+ 签名：$$s = h^d\ mod\ n$$
+ 验证：$$h = s^e\ mod\ n$$
+ 加密：$$c = m^e\ mod\ n$$
+ 解密：$$m = c^d\ mod\ n$$

由于$$d$$比$$e$$要大得多，直接进行计算，消耗的时间也会长得多。
真正的计算签名的算法过程是(解密同理)：

0. $$ s_1 = h^{d_p}\ mod\ p $$
0. $$ s_2 = h^{d_q}\ mod\ q $$
0. $$ t = ( q_{inv} \times (s_1-s_2))\ mod\ p$$
0. $$ s = s_2 + t \times q $$



