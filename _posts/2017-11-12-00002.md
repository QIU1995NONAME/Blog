---
layout: docs
title:  "OpenSSL 生成私钥 输出公钥"
date:   2017-11-12
categories: OpenSSL
enable_mathjax: false
enable_mermaid: false
---

仅仅是为了展示效果，密钥的位数设置为极其不安全的384位。在正常使用中密钥位数不要低于4096位。
<hr>

## 生成私钥与保护私钥
### 生成私钥
```bash
$ # 示例 openssl genrsa -out <输出的文件名> <密钥位数>
$ openssl genrsa -out sample.key 384
```
### 查看密钥文件内容
```bash
$ cat sample.key
-----BEGIN RSA PRIVATE KEY-----
MIHzAgEAAjEAy9P1h80Bo152m5lU/i+qkEvcS3NZeV8GsYHv9G+ujr9UsV9DhYO7
mcOsRDFhHksnAgMBAAECMQCt1xZG/3MROeTg6pKRxGetb/XwJ+481OyhysMcklvC
phvIqVmjfdaZV3ngWRvlDVECGQD9M1iOXXTHdPZ+oSLCWIrO1uNpkyw6MKkCGQDO
FN6xvXUNkkphrGpqEkw8PSBQlLmQb08CGE4Wq9UcVYu+MtdS8tllXUn1VCWXUiiQ
IQIZAJfR5jG5KnfCE0wbshXMvx8NxTW4K3DNnwIYaIzgVIpBGG4CkTl9psQDxDKV
+T596cX2
-----END RSA PRIVATE KEY-----
$ openssl rsa -in sample.key -noout -text
Private-Key: (384 bit)
modulus:
    00:cb:d3:f5:87:cd:01:a3:5e:76:9b:99:54:fe:2f:
    aa:90:4b:dc:4b:73:59:79:5f:06:b1:81:ef:f4:6f:
    ae:8e:bf:54:b1:5f:43:85:83:bb:99:c3:ac:44:31:
    61:1e:4b:27
publicExponent: 65537 (0x10001)
privateExponent:
    00:ad:d7:16:46:ff:73:11:39:e4:e0:ea:92:91:c4:
    67:ad:6f:f5:f0:27:ee:3c:d4:ec:a1:ca:c3:1c:92:
    5b:c2:a6:1b:c8:a9:59:a3:7d:d6:99:57:79:e0:59:
    1b:e5:0d:51
prime1:
    00:fd:33:58:8e:5d:74:c7:74:f6:7e:a1:22:c2:58:
    8a:ce:d6:e3:69:93:2c:3a:30:a9
prime2:
    00:ce:14:de:b1:bd:75:0d:92:4a:61:ac:6a:6a:12:
    4c:3c:3d:20:50:94:b9:90:6f:4f
exponent1:
    4e:16:ab:d5:1c:55:8b:be:32:d7:52:f2:d9:65:5d:
    49:f5:54:25:97:52:28:90:21
exponent2:
    00:97:d1:e6:31:b9:2a:77:c2:13:4c:1b:b2:15:cc:
    bf:1f:0d:c5:35:b8:2b:70:cd:9f
coefficient:
    68:8c:e0:54:8a:41:18:6e:02:91:39:7d:a6:c4:03:
    c4:32:95:f9:3e:7d:e9:c5:f6
```
### 加密以保护私钥文件
```bash
$ # 示例 openssl rsa -in <未被保护的私钥文件> <对称加密方式> -out <即将生成的私钥文件>
$ openssl rsa -in sample.key -aes-256-cbc -out sample.safe.key
$ cat sample.safe.key
-----BEGIN RSA PRIVATE KEY-----
Proc-Type: 4,ENCRYPTED
DEK-Info: AES-256-CBC,2B6B4D05592349A4D310D0F259AD64B9

bOZcf0+ki9YqeoA7Vk1cKT/yPDXu+GC7tblqGcHn4/cnJg1cPPiQKSRkHOMJNR87
dZZtm+abFwBKPFdiwuxwFW+zHptbTSLp+7tSeG3s3pn0+zOf9KIKu9XeZMS42C7u
bMQzkrxaqoWZT+yRxr5RoEBNwlMvubF8ozOU/QeDS81UuG2FUcrB4DlGFL64nEck
Bo0qBaWWajSUAJHY0iHjfqBTuh9rKfAbrP/xdozu8nB2/mJ1xkZXHarv6e2CCCYs
9OGboS0m7zynfefNJdmnHclrKY4ztQqZIx5fwNoBS3kuxlJ3PvjQstCl7qh/Pu3u
UsZm+tfpyD79/SqLkyGo3g==
-----END RSA PRIVATE KEY-----
```
**注意：** 在正式使用中，未被保护的私钥文件**应该被删除**。但为了展示效果，本文档使用的未加密的私钥文件并没有被删除。
## 使用私钥输出公钥
### 生成公钥信息
```bash
$ # 示例 openssl rsa -in <私钥文件> -pubout > <公钥文件>
$ openssl rsa -in sample.key -pubout > sample.pub
```
### 查看公钥信息
```bash
$ cat sample.pub
-----BEGIN PUBLIC KEY-----
MEwwDQYJKoZIhvcNAQEBBQADOwAwOAIxAMvT9YfNAaNedpuZVP4vqpBL3EtzWXlf
BrGB7/Rvro6/VLFfQ4WDu5nDrEQxYR5LJwIDAQAB
-----END PUBLIC KEY-----
$ # 示例 openssl rsa -pubin -in <公钥文件> -noout -text
$ openssl rsa -pubin -in sample.pub -noout -text
Public-Key: (384 bit)
Modulus:
    00:cb:d3:f5:87:cd:01:a3:5e:76:9b:99:54:fe:2f:
    aa:90:4b:dc:4b:73:59:79:5f:06:b1:81:ef:f4:6f:
    ae:8e:bf:54:b1:5f:43:85:83:bb:99:c3:ac:44:31:
    61:1e:4b:27
Exponent: 65537 (0x10001)
```
### 生成适用于SSH的公钥
```bash
$ # 示例 ssh-keygen -y -f <私钥文件> > <ssh公钥文件>
$ ssh-keygen -y -f sample.key > sample.sshpub
$ cat sample.sshpub
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAAAMQDL0/WHzQGjXnabmVT+L6qQS9xLc1l5Xwaxge/0b66Ov1SxX0OFg7uZw6xEMWEeSyc=
```







